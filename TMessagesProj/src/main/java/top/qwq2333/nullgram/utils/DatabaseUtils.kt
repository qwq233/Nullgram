/*
 * Copyright (C) 2019-2023 qwq233 <qwq233@qwq2333.top>
 * https://github.com/qwq233/Nullgram
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this software.
 *  If not, see
 * <https://www.gnu.org/licenses/>
 */

package top.qwq2333.nullgram.utils

import org.telegram.tgnet.TLObject


object DatabaseUtils {
    private val userOnly = hashSetOf(
        "account.acceptAuthorization",
        "account.cancelPasswordEmail",
        "account.changeAuthorizationSettings",
        "account.changePhone",
        "account.checkUsername",
        "account.confirmPasswordEmail",
        "account.confirmPhone",
        "account.createTheme",
        "account.declinePasswordReset",
        "account.deleteAccount",
        "account.deleteSecureValue",
        "account.finishTakeoutSession",
        "account.getAccountTTL",
        "account.getAllSecureValues",
        "account.getAuthorizationForm",
        "account.getAuthorizations",
        "account.getAutoDownloadSettings",
        "account.getChatThemes",
        "account.getContactSignUpNotification",
        "account.getContentSettings",
        "account.getGlobalPrivacySettings",
        "account.getMultiWallPapers",
        "account.getNotifyExceptions",
        "account.getNotifySettings",
        "account.getPassword",
        "account.getPasswordSettings",
        "account.getPrivacy",
        "account.getSecureValue",
        "account.getTheme",
        "account.getThemes",
        "account.getTmpPassword",
        "account.getWallPaper",
        "account.getWallPapers",
        "account.getWebAuthorizations",
        "account.initTakeoutSession",
        "account.installTheme",
        "account.installWallPaper",
        "account.registerDevice",
        "account.reportPeer",
        "account.reportProfilePhoto",
        "account.resendPasswordEmail",
        "account.resetAuthorization",
        "account.resetNotifySettings",
        "account.resetPassword",
        "account.resetWallPapers",
        "account.resetWebAuthorization",
        "account.resetWebAuthorizations",
        "account.saveAutoDownloadSettings",
        "account.saveSecureValue",
        "account.saveTheme",
        "account.saveWallPaper",
        "account.sendChangePhoneCode",
        "account.sendConfirmPhoneCode",
        "account.sendVerifyEmailCode",
        "account.sendVerifyPhoneCode",
        "account.setAccountTTL",
        "account.setAuthorizationTTL",
        "account.setContactSignUpNotification",
        "account.setContentSettings",
        "account.setGlobalPrivacySettings",
        "account.setPrivacy",
        "account.unregisterDevice",
        "account.updateDeviceLocked",
        "account.updateNotifySettings",
        "account.updatePasswordSettings",
        "account.updateProfile",
        "account.updateStatus",
        "account.updateTheme",
        "account.updateUsername",
        "account.uploadTheme",
        "account.uploadWallPaper",
        "account.verifyEmail",
        "account.verifyPhone",
        "auth.acceptLoginToken",
        "auth.cancelCode",
        "auth.checkPassword",
        "auth.checkRecoveryPassword",
        "auth.exportLoginToken",
        "auth.importLoginToken",
        "auth.recoverPassword",
        "auth.requestPasswordRecovery",
        "auth.resendCode",
        "auth.resetAuthorizations",
        "auth.sendCode",
        "auth.signIn",
        "auth.signUp",
        "channels.checkUsername",
        "channels.convertToGigagroup",
        "channels.createChannel",
        "channels.deleteChannel",
        "channels.deleteHistory",
        "channels.deleteUserHistory",
        "channels.editCreator",
        "channels.editLocation",
        "channels.exportMessageLink",
        "channels.getAdminedPublicChannels",
        "channels.getAdminLog",
        "channels.getGroupsForDiscussion",
        "channels.getInactiveChannels",
        "channels.getLeftChannels",
        "channels.getSponsoredMessages",
        "channels.inviteToChannel",
        "channels.joinChannel",
        "channels.readHistory",
        "channels.readMessageContents",
        "channels.reportSpam",
        "channels.setDiscussionGroup",
        "channels.togglePreHistoryHidden",
        "channels.toggleSignatures",
        "channels.toggleSlowMode",
        "channels.updateUsername",
        "channels.viewSponsoredMessage",
        "contacts.acceptContact",
        "contacts.addContact",
        "contacts.block",
        "contacts.blockFromReplies",
        "contacts.deleteByPhones",
        "contacts.deleteContacts",
        "contacts.getBlocked",
        "contacts.getContactIDs",
        "contacts.getContacts",
        "contacts.getLocated",
        "contacts.getSaved",
        "contacts.getStatuses",
        "contacts.getTopPeers",
        "contacts.importContacts",
        "contacts.resetSaved",
        "contacts.resetTopPeerRating",
        "contacts.search",
        "contacts.toggleTopPeers",
        "contacts.unblock",
        "folders.deleteFolder",
        "folders.editPeerFolders",
        "help.acceptTermsOfService",
        "help.dismissSuggestion",
        "help.editUserInfo",
        "help.getAppChangelog",
        "help.getAppConfig",
        "help.getAppUpdate",
        "help.getCountriesList",
        "help.getDeepLinkInfo",
        "help.getInviteText",
        "help.getNearestDc",
        "help.getPassportConfig",
        "help.getPromoData",
        "help.getProxyData",
        "help.getRecentMeUrls",
        "help.getSupport",
        "help.getSupportName",
        "help.getTermsOfServiceUpdate",
        "help.getUserInfo",
        "help.hidePromoData",
        "help.saveAppLog",
        "langpack.getDifference",
        "langpack.getLangPack",
        "langpack.getLanguage",
        "langpack.getLanguages",
        "langpack.getStrings",
        "messages.acceptEncryption",
        "messages.acceptUrlAuth",
        "messages.addChatUser",
        "messages.checkChatInvite",
        "messages.checkHistoryImport",
        "messages.checkHistoryImportPeer",
        "messages.clearAllDrafts",
        "messages.clearRecentStickers",
        "messages.createChat",
        "messages.deleteChat",
        "messages.deleteExportedChatInvite",
        "messages.deleteHistory",
        "messages.deletePhoneCallHistory",
        "messages.deleteRevokedExportedChatInvites",
        "messages.deleteScheduledMessages",
        "messages.discardEncryption",
        "messages.editChatAdmin",
        "messages.faveSticker",
        "messages.getAdminsWithInvites",
        "messages.getAllChats",
        "messages.getAllDrafts",
        "messages.getAllStickers",
        "messages.getArchivedStickers",
        "messages.getAttachedStickers",
        "messages.getAvailableReactions",
        "messages.getBotCallbackAnswer",
        "messages.getChatInviteImporters",
        "messages.getCommonChats",
        "messages.getDhConfig",
        "messages.getDialogFilters",
        "messages.getDialogs",
        "messages.getDialogUnreadMarks",
        "messages.getDiscussionMessage",
        "messages.getEmojiKeywords",
        "messages.getEmojiKeywordsDifference",
        "messages.getEmojiKeywordsLanguages",
        "messages.getEmojiURL",
        "messages.getExportedChatInvite",
        "messages.getExportedChatInvites",
        "messages.getFavedStickers",
        "messages.getFeaturedStickers",
        "messages.getHistory",
        "messages.getInlineBotResults",
        "messages.getMaskStickers",
        "messages.getMessageEditData",
        "messages.getMessageReactionsList",
        "messages.getMessageReadParticipants",
        "messages.getMessagesViews",
        "messages.getOldFeaturedStickers",
        "messages.getOnlines",
        "messages.getPeerDialogs",
        "messages.getPeerSettings",
        "messages.getPinnedDialogs",
        "messages.getPollResults",
        "messages.getPollVotes",
        "messages.getRecentLocations",
        "messages.getRecentStickers",
        "messages.getReplies",
        "messages.getSavedGifs",
        "messages.getScheduledHistory",
        "messages.getScheduledMessages",
        "messages.getSearchCounters",
        "messages.getSearchResultsCalendar",
        "messages.getSearchResultsPositions",
        "messages.getSplitRanges",
        "messages.getStatsURL",
        "messages.getStickers",
        "messages.getSuggestedDialogFilters",
        "messages.getUnreadMentions",
        "messages.getWebPage",
        "messages.getWebPagePreview",
        "messages.hideAllChatJoinRequests",
        "messages.hidePeerSettingsBar",
        "messages.importChatInvite",
        "messages.initHistoryImport",
        "messages.installStickerSet",
        "messages.markDialogUnread",
        "messages.migrateChat",
        "messages.readDiscussion",
        "messages.readEncryptedHistory",
        "messages.readFeaturedStickers",
        "messages.readHistory",
        "messages.readMentions",
        "messages.readMessageContents",
        "messages.receivedMessages",
        "messages.receivedQueue",
        "messages.reorderPinnedDialogs",
        "messages.reorderStickerSets",
        "messages.report",
        "messages.reportEncryptedSpam",
        "messages.reportSpam",
        "messages.requestEncryption",
        "messages.requestUrlAuth",
        "messages.saveDefaultSendAs",
        "messages.saveDraft",
        "messages.saveGif",
        "messages.saveRecentSticker",
        "messages.search",
        "messages.searchGifs",
        "messages.searchGlobal",
        "messages.searchStickerSets",
        "messages.sendEncrypted",
        "messages.sendEncryptedFile",
        "messages.sendEncryptedService",
        "messages.sendInlineBotResult",
        "messages.sendReaction",
        "messages.sendScheduledMessages",
        "messages.sendScreenshotNotification",
        "messages.sendVote",
        "messages.setChatAvailableReactions",
        "messages.setChatTheme",
        "messages.setDefaultReaction",
        "messages.setEncryptedTyping",
        "messages.setHistoryTTL",
        "messages.startBot",
        "messages.startHistoryImport",
        "messages.toggleDialogPin",
        "messages.toggleNoForwards",
        "messages.toggleStickerSets",
        "messages.uninstallStickerSet",
        "messages.updateDialogFilter",
        "messages.updateDialogFiltersOrder",
        "messages.uploadEncryptedFile",
        "messages.uploadImportedMedia",
        "msg_container",
        "msgs_ack",
        "payments.clearSavedInfo",
        "payments.getBankCardData",
        "payments.getPaymentForm",
        "payments.getPaymentReceipt",
        "payments.getSavedInfo",
        "payments.sendPaymentForm",
        "payments.validateRequestedInfo",
        "phone.acceptCall",
        "phone.checkGroupCall",
        "phone.confirmCall",
        "phone.createGroupCall",
        "phone.discardCall",
        "phone.discardGroupCall",
        "phone.editGroupCallParticipant",
        "phone.editGroupCallTitle",
        "phone.exportGroupCallInvite",
        "phone.getCallConfig",
        "phone.getGroupCall",
        "phone.getGroupCallJoinAs",
        "phone.getGroupParticipants",
        "phone.inviteToGroupCall",
        "phone.joinGroupCall",
        "phone.joinGroupCallPresentation",
        "phone.leaveGroupCall",
        "phone.leaveGroupCallPresentation",
        "phone.receivedCall",
        "phone.requestCall",
        "phone.saveCallDebug",
        "phone.saveDefaultGroupCallJoinAs",
        "phone.sendSignalingData",
        "phone.setCallRating",
        "phone.startScheduledGroupCall",
        "phone.toggleGroupCallRecord",
        "phone.toggleGroupCallSettings",
        "phone.toggleGroupCallStartSubscription",
        "photos.deletePhotos",
        "photos.updateProfilePhoto",
        "photos.uploadProfilePhoto",
        "stats.getBroadcastStats",
        "stats.getMegagroupStats",
        "stats.getMessagePublicForwards",
        "stats.getMessageStats",
        "stats.loadAsyncGraph",
        "stickers.checkShortName",
        "stickers.suggestShortName",
        "upload.getCdnFile",
        "upload.getWebFile"
    )

    @JvmStatic
    fun getMethodName(method: TLObject): String {
        val name = method.toString()
        val start = name.indexOf("$") + 4
        val end = name.indexOf("@")
        return name.substring(start, end).replace("_", ".")
    }

    @JvmStatic
    fun isUserOnlyMethod(method: TLObject): Boolean {
        return userOnly.contains(getMethodName(method))
    }

}
